--- a/zzip/memdisk.c
+++ b/zzip/memdisk.c
@@ -261,7 +274,10 @@ zzip_mem_entry_extra_block(ZZIP_MEM_ENTRY * entry, short datatype)
             {
                 if (datatype == zzip_extra_block_get_datatype(ext))
                 {
-                    return ((ZZIP_EXTRA_BLOCK*) ext);
+                    if (12 <= zzip_extra_block_get_datasize(ext))
+                    {
+                        return ((ZZIP_EXTRA_BLOCK*) ext);
+                    }
                 }
                 /* skip to start of next extra_block */
                 ___ zzip_size_t datasize = zzip_extra_block_get_datasize(ext);
